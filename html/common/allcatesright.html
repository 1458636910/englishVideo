<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no" />
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css" />
    <link rel="stylesheet" type="text/css" href="../../css/iconfont.css" />
    <style>
        body {}

        * {
            -webkit-overflow-scrolling: touch
        }

        #app {
            background: white;
            min-height: 100vh;
            /*padding-top: 3vw;*/
            box-sizing: border-box;
            padding-bottom: 20vw;
        }

        [v-cloak] {
            /*display: none;*/
        }
        /**/

        .catesL {
            width: 20vw;
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            height: 100%;
            overflow-y: scroll;
        }

        .catesR {
            width: 100vw;
            height: 100%;
            overflow-y: scroll;
        }

        .slidenav,
        .catesCount {
            height: max-content;
        }

        .slide {
            padding: 1vw;
            height: 10vw;
            text-align: center;
            border-bottom: 1px solid #d6d4d4;
            border-left: 2px solid none;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slideActive {
            background: white;
            border-left: 2px solid #F9617F;
        }

        .cates {
            /*padding-left: 20vw;*/
            /*height: 100vh;*/
            /*display: flex;*/
        }

        .cateTit {
            text-align: center;
            padding: 3vw;
            /*font-weight: 700;*/
            color: #243150;
        }

        .cateslists {
            display: flex;
            flex-wrap: wrap;
            padding: 2vw;
        }

        .cateslist {
            text-align: center;
            width: 30vw;
            margin-right: 2vw;
            margin-bottom: 3vw;
        }

        .cateslist:nth-child(3n+3) {
            margin-right: 0;
        }

        .cateslist img {
            width: 28vw;
            height: 28vw;
            margin: auto;
            border-radius: 5px;
            object-fit: cover;
        }

        .catesName {
            font-size: 12px;
            overflow: hidden;
            color: #666667;
            text-align: center;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;
        }

        .catesR {
            background: white;
        }

        .slide span {
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        [v-cloak] {
            display: none;
        }
        /**/

        .cateTit.gjp {
            width: 50%;
            margin: auto;
            /*height: 18px;*/
            background: #f5f5f5;
        }

        .cateslist img.gjp {
            background: #f5f5f5;
            border: 0;
        }

        .catesName.gjp {
            height: 16px;
            background: #f5f5f5;
            width: 80%;
            margin: auto;
        }

        .empty img {
            max-width: 50vw;
            display: block;
            margin: auto;
        }
    </style>
</head>

<body>
    <div id="app">
        <div class="cates" id="cates">
            <div class="catesR" v-if="slideNavs.length == 0 && !datasOk">
                <div class="catesCount">
                    <div class="cateslistBox">
                        <p class="cateTit gjp"></p>
                        <div class="cateslists">
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                        </div>
                    </div>
                    <div class="cateslistBox">
                        <p class="cateTit gjp"></p>
                        <div class="cateslists">
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                        </div>
                    </div>
                    <div class="cateslistBox">
                        <p class="cateTit gjp"></p>
                        <div class="cateslists">
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                            <div class="cateslist">
                                <img class="gjp" src="" alt="">
                                <p class="catesName gjp"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="empty" v-if="slideNavs.length == 0">
                <img src="../../image/empty.png" alt="">
            </div>
            <div class="catesR" v-if="slideNavs.length > 0" v-cloak>
                <div class="catesCount" v-for="(item,index) in slideNavs" v-show="slideActive == index">
                    <div class="empty" v-if="item.subs_status == 0">
                        <img src="../../image/empty.png" alt="">
                    </div>
                    <div class="cateslistBox" v-for="(ite,ind) in item.subs">
                        <p class="cateTit">{{ite.title}}</p>
                        <div class="cateslists">
                            <div class="cateslist" @click="goshopcate(it)" v-for="(it,id) in ite.subs">
                                <img v-lazy="it.thumb" alt="">
                                <p class="catesName">{{it.title}}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/fastclick.js"></script>
<script type="text/javascript" src="../../script/lazyload.js"></script>
<script src="../../script/vue.min.js"></script>
<script src="../../script/commonurl.js"></script>
<script type="text/javascript">
    var app;
    apiready = function() {
        Vue.use(VueLazyload, {
            preLoad: 1.3,
            error: '../../image/errorimg.png',
            loading: '../../image/loading.svg',
            attempt: 1
        })
        app = new Vue({
            el: '#app',
            data() {
                return {
                    slideActive: 0,
                    slideNavs: [],
                    datasOk: false,

                }
            },
            created() {
                var datas = api.readFile({
                    sync: true,
                    path: 'fs://allcatesLists.txt'
                });
                if (datas) {
                    this.slideNavs = JSON.parse(datas)
                    this.datasOk = true
                }

                this.getCates()
                setTimeout(() => {
                    this.datasOk = true
                }, 5000)
            },
            methods: {
                setActive(e) {
                    if (this.slideActive == e) {
                        return
                    }
                    // alert(JSON.stringify(this.slideNavs[e]))
                    this.slideActive = e
                    window.scrollTo(0, 0);
                    // api.pageUp({
                    //   top:true
                    // },function( ret, err ){
                    //
                    // });
                },
                getCates() {
                    var _this = this;
                    requstGet('store/category', '', function success(ret) {
                        _this.slideNavs = ret.data
                            // var listData = ret.data;
                            // for (var i = 0; i < listData.length; i++) {
                            //   if (listData[i].subs_status) {
                            //     for (var j = 0; j < listData[i].subs.length; j++) {
                            //       if (listData[i].subs[j].subs_status) {
                            //         for (var k = 0; k < listData[i].subs[j].subs.length; k++) {
                            //          var imgsObj =  listData[i].subs[j].subs[k]
                            //          api.imageCache({
                            //              url: imgsObj.thumb,
                            //              tag: i
                            //          }, function(ret, err) {
                            //            // console.log(JSON.stringify(ret));
                            //              imgsObj.thumb = ret.url;
                            //          });
                            //         }
                            //       }
                            //     }
                            //   }
                            // }
                            // _this.slideNavs = listData
                        api.writeFile({
                            path: 'fs://allcatesLists.txt',
                            data: JSON.stringify(ret.data)
                        }, function(ret, err) {
                            // alert(JSON.stringify(ret))
                            if (ret.status) {
                                //成功
                            } else {

                            }
                        });
                    }, function fail(err) {

                    })
                },
                goshopcate(ite) {
                    api.openWin({
                        name: 'shopcate_win',
                        url: './shopcate_win.html',
                        pageParam: {
                            name: ite.title,
                            id: ite.id
                        }
                    });

                },
                changeSlide(ite, ind) {
                    this.slideActive = ind
                },

            }
        })

    };
</script>

</html>
